<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>distcrete • distcrete</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">distcrete</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/distcrete.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/reconhub/distcrete">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>distcrete</h1>
                        <h4 class="author">Rich FitzJohn, Thibaut Jombart</h4>
            
            <h4 class="date">2017-11-22</h4>
          </div>

    
    
<div class="contents">
<p><code>distcrete</code> discretises probability distributions.</p>
<div id="why" class="section level2">
<h2 class="hasAnchor">
<a href="#why" class="anchor"></a>Why?</h2>
<p>The discrete observation of continuous processes is fairly frequent in a range of fields including biology, ecology, and epidemiology. This is typically the case when recording the dates of events as days, weeks, or months, thereby altering the distribution of delays between these events. Let us imagine that events are recorded per day. Two events happening on the same day at 10am and 10pm would result in an observed delay of 0 days (while the actual delay is 12h), while two events happening 2h hours apart, at 11pm first and at 1am on the next day, would be seen as 1 day apart.</p>
<p>Because of such potential biases, discretisation needs to be taken into account when fitting distributions of discretised quantities (such as delays), as well as when simulating them. Quite often, existing discrete distributions are not sufficient to obtain a good fit of discretised data. <strong><code>distcrete</code></strong> provides an alternative by implementing a general approach for discretising continuous distributions.</p>
</div>
<div id="how-it-works" class="section level2">
<h2 class="hasAnchor">
<a href="#how-it-works" class="anchor"></a>How it works</h2>
<p>This section covers both the <em>interface</em> in the package and the ideas behind how the distributions are generated. There are many possible ways of discretising a given distribution onto a set of values and this section tries to justify the approaches taken here and explain how the user can modify them.</p>
<div id="mapping-continuous-values-to-an-underlying-discrete-grid" class="section level3">
<h3 class="hasAnchor">
<a href="#mapping-continuous-values-to-an-underlying-discrete-grid" class="anchor"></a>Mapping continuous values to an underlying discrete grid</h3>
<p>This section applies to all the content below. Suppose we have a continuous distribution that is defined on some domain [a, b] (possibly infinite). For example, a gamma distribution with shape 3 and rate 1:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">curve</span>(<span class="kw">dgamma</span>(x, <span class="dv">3</span>), <span class="dv">0</span>, <span class="dv">10</span>, <span class="dt">n =</span> <span class="dv">301</span>)</code></pre></div>
<p><img src="distcrete_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<p>To discretise this we define:</p>
<ul>
<li><p><code>interval</code>: the (uniform) frequency of discretisation; perhaps 1. There is no default here as you have to decide how your distribution is to be discretised.</p></li>
<li><p><code>anchor</code>: a single value point at which discretisation is valid; perhaps 0 (which is the default). Once an anchor is specified we know that valid ‘x’ positions are {…, <code>anchor - 2 * interval</code>, <code>anchor - interval</code>, <code>anchor</code>, <code>anchor + interval</code>, <code>anchor + 2 *   interval</code>, …} where those are on the domain of our underlying distribution.</p></li>
<li><p><code>w</code>: how to collapse intermediate values, and probabilities into the interval. Given that we want a discrete probability mass for position <code>x</code> (which is one of the valid values above), this defines the domain of the underlying function that we integrate over. Specifically we integrate from <code>x - w * interval</code> to <code>x -   (1 - w) * interval</code>. So specifying <code>interval = 1, anchor = 0, w   = 0</code> means that looking up position <code>0</code> integrates the dstribution over <code>[0, 1]</code>. In contrast specifying <code>w = 0.5</code> will integrate over <code>[-0.5, 0.5]</code>.</p></li>
</ul>
<p>To illustrate:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d0 &lt;-<span class="st"> </span>distcrete::<span class="kw"><a href="../reference/distcrete.html">distcrete</a></span>(<span class="st">"gamma"</span>, <span class="dv">1</span>, <span class="dt">shape =</span> <span class="dv">3</span>, <span class="dt">w =</span> <span class="dv">0</span>)
d1 &lt;-<span class="st"> </span>distcrete::<span class="kw"><a href="../reference/distcrete.html">distcrete</a></span>(<span class="st">"gamma"</span>, <span class="dv">1</span>, <span class="dt">shape =</span> <span class="dv">3</span>, <span class="dt">w =</span> <span class="fl">0.5</span>)
x &lt;-<span class="st"> </span><span class="dv">0</span>:<span class="dv">10</span>
y0 &lt;-<span class="st"> </span>d0$<span class="kw">d</span>(x)
y1 &lt;-<span class="st"> </span>d1$<span class="kw">d</span>(x)

<span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))
col &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"gold"</span>, <span class="st">"steelblue3"</span>)
r &lt;-<span class="st"> </span><span class="kw">barplot</span>(<span class="kw">rbind</span>(y0, y1), <span class="dt">names.arg =</span> <span class="dv">0</span>:<span class="dv">10</span>, <span class="dt">beside =</span> <span class="ot">TRUE</span>,
             <span class="dt">xlab =</span> <span class="st">"x"</span>, <span class="dt">ylab =</span> <span class="st">"Probability mass"</span>, <span class="dt">las =</span> <span class="dv">1</span>,
             <span class="dt">col =</span> col)
<span class="kw">legend</span>(<span class="st">"topright"</span>, <span class="kw">c</span>(<span class="st">"w = 0"</span>, <span class="st">"w = 0.5"</span>), <span class="dt">bty =</span> <span class="st">"n"</span>, <span class="dt">fill =</span> col)</code></pre></div>
<p><img src="distcrete_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>Summed over all ‘x’, these two distributions will both equal 1 (using 100 as “close enough” to infinity here)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(d0$<span class="kw">d</span>(<span class="dv">0</span>:<span class="dv">100</span>))</code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(d1$<span class="kw">d</span>(<span class="dv">0</span>:<span class="dv">100</span>))</code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>but the way that probability distribution is spread over the discrete ‘x’ locations differs.</p>
</div>
<div id="cumulative-density-function" class="section level3">
<h3 class="hasAnchor">
<a href="#cumulative-density-function" class="anchor"></a>Cumulative density function</h3>
<p>The cumulative density function (CDF) is key to all calculations throughout.</p>
<p>We follow R’s lead on naturally discrete distributions (e.g. Poisson) and define the cdf as the cumulative probability at x as the probability up to <em>and including</em> x. So this is simply, for an aligned <code>x</code> value this is the cdf of the underlying distribution up to <code>x + (1 - w) * interval</code>.</p>
<p>So with <code>w = 1</code>, the regions integrated are coloured below; for the cumulative density we integrate from -Inf to the line <em>above</em> the point of interest.</p>
<p><img src="distcrete_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>and with <code>w = 0.5</code> <img src="distcrete_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>The nice thing about this is we can do these calculation without doing any integration; these follow directly from the cumulative density function of the underlying continuous distribution</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))
<span class="kw">curve</span>(<span class="kw">pgamma</span>(x, <span class="dv">3</span>), <span class="dv">0</span>, <span class="dv">10</span>, <span class="dt">n =</span> <span class="dv">301</span>, <span class="dt">col =</span> <span class="ot">NA</span>,
      <span class="dt">xlab =</span> <span class="st">"x"</span>, <span class="dt">ylab =</span> <span class="st">"Cumulative probability"</span>, <span class="dt">las =</span> <span class="dv">1</span>)
at &lt;-<span class="st"> </span><span class="dv">0</span>:<span class="dv">10</span>
cols &lt;-<span class="st"> </span><span class="kw">colorRampPalette</span>(<span class="kw">c</span>(<span class="st">"navy"</span>, <span class="st">"dodgerblue2"</span>))(<span class="kw">length</span>(at))
for (i in <span class="kw">seq_along</span>(at)[-<span class="dv">1</span>]) {
  xx &lt;-<span class="st"> </span><span class="kw">seq</span>(at[i -<span class="st"> </span><span class="dv">1</span>], at[i], <span class="dt">length.out =</span> <span class="dv">21</span>)
  <span class="kw">polygon</span>(<span class="kw">c</span>(xx, <span class="kw">rev</span>(xx)),
          <span class="kw">c</span>(<span class="kw">pgamma</span>(xx, <span class="dv">3</span>), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">length</span>(xx))), <span class="dt">col =</span> cols[i],
          <span class="dt">border =</span> <span class="st">"grey"</span>)
}
<span class="kw">curve</span>(<span class="kw">pgamma</span>(x, <span class="dv">3</span>), <span class="dv">0</span>, <span class="dv">10</span>, <span class="dt">n =</span> <span class="dv">301</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="distcrete_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>(this is with <code>w = 0</code>)</p>
</div>
<div id="probability-density-function-to-probability-mass-function" class="section level3">
<h3 class="hasAnchor">
<a href="#probability-density-function-to-probability-mass-function" class="anchor"></a>Probability density function to probability mass function</h3>
<p>We have an underlying continuous distribution with a known discretised CDF <span class="math inline">\(F_d(x)\)</span>. To compute the density at <span class="math inline">\(x\)</span> we compute how much probability is consumed between <code>x</code> and <code>x + interval</code>, we can compute <span class="math inline">\(F_d(x + interval) - F_d(x)\)</span>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#why">Why?</a></li>
      <li><a href="#how-it-works">How it works</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Steph Locke, Rich FitzJohn, Anne Cori, Thibaut Jombart.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
